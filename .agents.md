# Repository Guidelines

Welcome to the karakeep-ai-organizer project. This guide keeps contributions consistent, fast to review, and easy to extend.

## Project Structure & Module Organization
- `src/` — app code grouped by domain (e.g., `ingestion/`, `organizer/`, `ui/`).
- `tests/` — mirrors `src/`; fixtures in `tests/fixtures/`; sample data in `tests/data/`.
- `scripts/` — maintenance/data prep; keep idempotent and note usage at the top of each script.
- `docs/` — architecture notes and ADRs; diagrams (Mermaid/PlantUML) when they clarify flows.
- `config/` — configuration defaults (YAML/TOML/JSON); never commit secrets. Provide `.env.example` in the root.

## Build, Test, and Development Commands
- Use Python 3.11+ (preferred). If a JS frontend appears, target Node 20+. Create a venv: `python -m venv .venv && source .venv/bin/activate`.
- Install dev deps: `pip install -r requirements-dev.txt` (or `npm install` for JS packages).
- Preferred `Makefile` targets (add if missing): `make format` (black+isort/prettier), `make lint` (ruff/eslint), `make test` (pytest/vitest), `make check` (mypy/tsc).
- Run locally via `python -m src.main` or `npm run dev` once entrypoints exist.

## Coding Style & Naming Conventions
- PEP 8 with black (88 cols) and isort; type-hint public functions; snake_case for modules/functions, PascalCase for classes, UPPER_SNAKE for constants.
- Keep functions small; push I/O to edges; prefer dependency injection over globals.
- Document non-obvious logic briefly; avoid TODOs without issue links.

## Testing Guidelines
- Pytest baseline; name files `test_*.py` mirroring package paths. For JS, use vitest/jest with `*.test.ts`.
- Target ~90% line coverage on core modules; add regression tests with each bug fix.
- Seed deterministic data; avoid network calls—mock external APIs.

## Commit & Pull Request Guidelines
- Commits: short imperative subject (≤72 chars) and focused diff, e.g., `add task parser for email input`.
- PRs: state problem, solution, testing notes, and screenshots/JSON samples for UI or API changes. Link issues/tickets. Split PRs that exceed ~400 lines.

## Security & Configuration Tips
- Keep secrets in `.env`; never commit keys. Rotate test credentials.
- Validate user input at boundaries; log as structured JSON and redact sensitive fields.
- Use `pre-commit` with format/lint hooks to catch issues before pushing.

## Agent-Specific Notes
- Prefer `rg` for search and `make` targets over bespoke commands. If the repo lacks a target or script, add it with a brief comment and update this guide.
